define(["jquery"],(function(t){function o(o){void 0===o&&(o={}),void 0===o.content_end_container&&(o.content_end_container=".end-content"),void 0===o.menu_obj&&(o.menu_obj="#right_content"),void 0===o.content_container&&(o.content_container=".content.layout-container"),void 0===o.element_container&&(o.element_container=".right_content_container"),void 0===o.content_header_container&&(o.content_header_container="#header-bar"),this.options=o;var n=this;this.initVariables=function(){this.w_height=window.innerHeight,this.w_width=window.innerWidth,this.m_height=t(this.options.menu_obj).outerHeight(),this.position=t(this.options.menu_obj).offset(),this.content_margin_top=parseInt(t(this.options.content_container).offset().top),this.previous_scroll=t(window).scrollTop(),t(this.options.element_container).css({height:t(this.options.menu_obj).outerHeight()+"px"});var o=n.content_margin_top;(t(n.options.menu_obj).css("position","fixed").css("top",o+"px"),o<this.content_margin_top-t(window).scrollTop()&&(o=this.content_margin_top-t(window).scrollTop()),t(n.options.menu_obj).offset().top+n.m_height>t(this.options.content_end_container).offset().top)&&(o-=t(n.options.menu_obj).offset().top+n.m_height-t(this.options.content_end_container).offset().top);t(n.options.menu_obj).css("position","fixed").css("top",o+"px")},this.initVariables(),t(this.options.menu_container).height(this.m_height),t(this.options.menu_obj).sizeChanged((function(){t(n.options.element_container).css({height:t(n.options.menu_obj).outerHeight()+"px"}),n.initVariables()})),this.onResize=function(){t(n.options.element_container).css({height:t(n.options.menu_obj).outerHeight()+"px"}),"fixed"===t(n.options.menu_obj).css("position")&&(n.w_height=window.innerHeight,n.w_width=window.innerWidth)},this.addEventListener=function(t,o,n,i){void 0!==typeof t&&null!=t&&t.addEventListener?t.addEventListener(o,n,i):void 0!==typeof t&&null!=t&&t.attachEvent&&t.attachEvent("on"+o,n)},this.onScroll=function(o){if("undefined"!=n.m_height&&"fixed"===t(n.options.menu_obj).css("position")){this.content_margin_top=parseInt(t(n.options.content_container).offset().top);var i=parseInt(t(n.options.menu_obj).css("top"));isNaN(i)&&(i=n.content_margin_top),i-=t(window).scrollTop()-n.previous_scroll;var e=t(window).scrollTop()+n.w_height-t(n.options.content_end_container).offset().top;i<n.w_height-n.m_height&&(i=n.w_height-n.m_height,e>0&&(i-=e)),i>n.content_margin_top&&(i=n.content_margin_top),t(n.options.content_end_container).offset().top<n.m_height+t(n.options.menu_obj).offset().top&&(i-=n.m_height+t(n.options.menu_obj).offset().top-t(n.options.content_end_container).offset().top,t(n.options.menu_obj).css("position","fixed").css("top",i+"px")),t(document).height()<n.m_height&&(i=-1*(t(window).scrollTop()-n.content_margin_top),t(n.options.menu_obj).css("position","fixed").css("top",i+"px"));var s=t(window).scrollTop()+i;s<n.content_margin_top&&(i+=n.content_margin_top-s,t(n.options.menu_obj).css("position","fixed").css("top",i+"px")),t(n.options.menu_obj).css("position","fixed").css("top",i+"px"),n.previous_scroll=t(window).scrollTop()}},t(window).on("scroll mousewheel DOMMouseScroll",this.onScroll),this.addEventListener(window,"resize",this.onResize),this.onScroll()}return function(t){t.fn.sizeChanged=function(t){var o=this,n=o.offsetWidth,i=o.offsetHeight;return setInterval((function(){n===o.offsetWidth&&i===o.offsetHeight||"function"==typeof t&&(t({width:n,height:i},{width:o.offsetWidth,height:o.offsetHeight}),n=o.offsetWidth,i=o.offsetHeight)}),100),o}}(t),{create:function(t){return new o(t)}}}));